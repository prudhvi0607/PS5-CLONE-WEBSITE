/*!
 * @sie/designkit
 * @copyright     2024 Sony Interactive Entertainment LLC, all rights reserved
 */

!function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,i(a.key),a)}}function n(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function a(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function i(e){var t=a(e,"string");return"symbol"==typeof t?t:String(t)}var o=({endpoint:_gpdc.elements.$body.data("wc-api"),arkhamAPIHost:_gpdc.elements.$body.data("arkham-api"),arkhamAPIPath:"/api/session/v1/signin?redirect_uri=CURRENT_PAGE_URL&flow=web:walletAdmin",loadingClass:"loading",loadedAction:"checkout_app_visible",loginAction:"checkout_signin_required",pswrdVerifAction:"checkout_password_verification_required",closeActions:["checkout_cart_cancel","checkout_continue_shopping","checkout_error_dismiss","checkout_thankyou_dismiss"]},function(e){if(!e||"false"===e)return null;if(e.startsWith("#"))return e;var t=/^rgba\(/.test(e);e=e.substring(t?5:4).split(")")[0].split(e.indexOf(",")>-1?",":" ");var n=(+e[0]).toString(16),a=(+e[1]).toString(16),i=(+e[2]).toString(16);if(n=1==n.length?"0".concat(n):n,a=1==a.length?"0".concat(a):a,i=1==i.length?"0".concat(i):i,!t)return"#".concat(n).concat(a).concat(i);var o=Math.round(255*+e[3]).toString(16);return o=1==o.length?"0".concat(o):o,"#".concat(n).concat(a).concat(i).concat(o)}),r=function(e){var t=e.length>7;return"".concat(t?e.substring(0,7):e,"00")},c=function(e,t,n,a,i,c){var s=e.data(t)||"";if(s){var d={};s=o(s),a&&(d={"--gradient-start-color":s,"--gradient-end-color":r(s)}),i&&(d["--gradient-start-color-tablet"]=s,d["--gradient-end-color-tablet"]=r(s)),c&&(d["--gradient-start-color-desktop"]=s,d["--gradient-end-color-desktop"]=r(s)),n&&(d[n]=s),e.css(d)}},s={IS_PORTRAIT:(window.matchMedia&&matchMedia("(orientation: portrait)")||{}).matches,IS_LANDSCAPE:(window.matchMedia&&matchMedia("(orientation: landscape)")||{}).matches,IS_MOBILE:(window.matchMedia&&matchMedia("(max-width: 767px)")||{}).matches,IS_MOBILE_PORTRAIT:(window.matchMedia("(max-width: 767px) and (orientation: portrait)")||{}).matches,IS_TABLET:(window.matchMedia&&matchMedia("(min-width: 768px)")||{}).matches,IS_DESKTOP:(window.matchMedia&&matchMedia("(min-width: 1024px)")||{}).matches},d={IS_PORTRAIT:window.matchMedia&&matchMedia("(orientation: portrait)")||{},IS_LANDSCAPE:window.matchMedia&&matchMedia("(orientation: landscape)")||{},IS_JETSTREAM_MOBILE:window.matchMedia&&matchMedia("(max-width: 699px)")||{},IS_MOBILE:window.matchMedia&&matchMedia("(max-width: 767px)")||{},IS_MOBILE_PORTRAIT:window.matchMedia("(max-width: 767px) and (orientation: portrait)")||{},IS_TABLET:window.matchMedia&&matchMedia("(min-width: 768px)")||{},IS_TABLET_LG:window.matchMedia&&matchMedia("(min-width: 1024px)")||{},IS_LAPTOP:window.matchMedia&&matchMedia("(min-width: 1367px)")||{},IS_DESKTOP:window.matchMedia&&matchMedia("(min-width: 1920px)")||{},IS_MAX_TABLET:window.matchMedia&&matchMedia("(max-width: 1023px)")||{},IS_JUST_TABLET:window.matchMedia&&matchMedia("(min-width: 768px) and (max-width: 1365px)")||{},IS_JUST_LAPTOP:window.matchMedia&&matchMedia("(min-width: 1366px) and (max-width: 1919px)")||{}},l=({IS_PORTRAIT:d.IS_PORTRAIT.matches,IS_LANDSCAPE:d.IS_LANDSCAPE.matches,IS_JETSTREAM_MOBILE:d.IS_JETSTREAM_MOBILE.matches,IS_MOBILE:d.IS_MOBILE.matches,IS_MOBILE_PORTRAIT:d.IS_MOBILE_PORTRAIT.matches,IS_TABLET:d.IS_TABLET.matches,IS_MAX_TABLET:d.IS_MAX_TABLET.matches,IS_TABLET_LG:d.IS_TABLET_LG.matches,IS_LAPTOP:d.IS_LAPTOP.matches,IS_DESKTOP:d.IS_DESKTOP.matches},{EMPTY_LABEL:"empty"}),h=/^(https?\:)?(\/{2})(store\.(playstation|sonyentertainmentnetwork))/,m=/^(psns\:browse)/,p=/^(https?\:)?(\/{2})(direct\.(playstation|sonyentertainmentnetwork))/,u=function(e){return"string"==typeof e&&(h.test(e)||m.test(e))},_=function(e){return e&&p.test(e)},g=function(){function t(){e(this,t),this.bannerImpressionTimeout=500,this.BANNER_SELECTORS={mobileContent:".page-banner__content-wrapper\\@mobile .page-banner__content",desktopContent:".page-banner__content-wrapper:not(.page-banner__content-wrapper\\@mobile) .page-banner__content",desktopLogoContent:".page-banner__content-wrapper:not(.page-banner__content-wrapper\\@mobile) .page-banner__logo-content"}}return n(t,[{key:"trackBannerEvent",value:function(e,t,n,a,i){var o=i.hasClass("hp-hero__banner"),r=o?"homepage hero banner":"pagebanner";return _gpdc.analytics.event.addGDLEvent(t,"".concat(e).concat("click"===t?r:""),{userActionFlag:!1,moduleName:r,label:l.EMPTY_LABEL,position:n.data("analytics-position"),linkUrl:a||l.EMPTY_LABEL,assetName:n.data("analytics-asset")||l.EMPTY_LABEL,elementType:n.data("media-type-".concat(s.IS_TABLET?"tablet":"mobile"))||"image"},n),Promise.resolve()}},{key:"setAnalyticsAttrs",value:function(e,t,n,a){var i=e.find(".media-block--bg"),o=i.hasClass("+inline-video");t.data("analytics-position",a+1),t.data("module-name",n?"".concat(_gpdc.config.templateName," hero banner"):"pagebanner"),t.data("media-type-mobile",o&&!i.hasClass("+inline-video--none")&&"video"||"image"),t.data("media-type-tablet",o&&!i.hasClass("+inline-video--none@tablet")&&"video"||"image")}},{key:"onBannerClick",value:function(e,t){e.preventDefault();var n=$(e.target),a=$(e.currentTarget);if(!n.length||!n.hasClass("icon")&&!n.closest(".media-block__overlay").length){var i=a.attr("href")||"";this.trackBannerEvent("select ","click",a,i,t).then(function(){_gpdc.analytics._satelliteTrack("banner_click"),i&&(window.location.href=i)})}}},{key:"addWaypointAnimation",value:function(e,t){var n=this,a=e.data("bg-animation")||"",i=e.data("content-animation")||"",o=e.hasClass("+logo--none"),r=new Waypoint({element:e.get(0),handler:function(){setTimeout(function(){n.trackBannerEvent("banner impression","impression",t,t.attr("href"),e)},n.bannerImpressionTimeout),n.bannerImpressionTimeout=0,r.destroy()},offset:"20%"});if(a)var c=new Waypoint({element:e.get(0),handler:function(){e.addClass(a),c.destroy()},offset:"90%"});if(i){var s=e.find(this.BANNER_SELECTORS.mobileContent),d=e.find(this.BANNER_SELECTORS.desktopContent);if(s&&s.length)var l=o||e.hasClass("+logo@mobile--none"),h=new Waypoint({element:s.get(0),handler:function(){$(h.element).is(":visible")&&(e.addClass(i),h.destroy())},offset:l?"75%":"60%"});if(d&&d.length)var m=o||e.hasClass("+logo@desktop--none"),p=new Waypoint({element:d.get(0),handler:function(){$(p.element).is(":visible")&&(e.addClass(i),p.destroy())},offset:m?"75%":"50%"})}}},{key:"setZIndexForProductBanners",value:function(e,t){e.hasClass("page-banner--featured")&&e.attr("class").indexOf("+feature-overflow--bo")>-1&&e.css("z-index",t+2)}},{key:"setBannerContentWidthDesktop",value:function(e){var t=e.find(".page-banner__content-wrapper .page-banner__logo"),n=e.find(".page-banner__feature"),a=n.length&&n.outerHeight()||null,i=0;if(t&&t.length||e.hasClass("hp-hero__banner")){try{i=e.find(this.BANNER_SELECTORS.desktopLogoContent).actual("outerHeight")}catch(t){i=e.find(this.BANNER_SELECTORS.desktopLogoContent).outerHeight(),_gpdc.Logger.log("jQuery Actual not found! falling back to outerHeight()")}e.css("--banner-content-calc-height","".concat(i,"px"))}a&&n.css("--banner-feature-calc-height","".concat(a,"px"))}},{key:"setupContentHeightCalculator",value:function(e){var t=this;_gpdc.elements.$window.on("resize.dkPageBannerComponent",function(){return t.setBannerContentWidthDesktop(e)})}},{key:"processPageBanners",value:function(e){var t=this;$.each(e,function(e,n){var a=$(n),i=a.hasClass("hp-hero__banner"),o=a.hasClass("page-banner-v2"),r=a.find(".page-banner__keyart-anchor");c(a,"banner-theme","--custom-banner-theme",!0,!1,!0);var s=r.attr("href")||"";if(s&&(u(s)||_(s))&&r.attr("href",_gpdc.analytics.commerce.appendCIDs(s,r.get(0),"pagebanner")),i){var d=a.data("bg-animation")||"",l=a.data("content-animation")||"";a.addClass("".concat(d," ").concat(l))}else t.addWaypointAnimation(a,r);!o&&t.setBannerContentWidthDesktop(a),t.setZIndexForProductBanners(a,e),t.setAnalyticsAttrs(a,r,i,e),!!r.attr("href")&&r.on("click.dkPageBannerComponent",function(e){return t.onBannerClick(e,a)}),!o&&t.setupContentHeightCalculator(a)})}},{key:"init",value:function(){var e=$('[data-component="page-banner"]');return!(!e||!e.length)&&(this.processPageBanners(e),void _gpdc.Logger.logInitializer("banners","components","Page Banner"))}}]),t}(),f=function(){function t(){var n=this;e(this,t),window._gpdc&&_gpdc.user&&"undefined"!=typeof _gpdc.user.isLoggedIn?this.initModules():_gpdc.elements.$document.one("userInfoSet.dkComponents",function(){return n.initModules()})}return n(t,[{key:"initModules",value:function(){var e=new g;e.init()}}]),t}();!function(e){_gpdc.elements.$document.ready(function(){new f})}(jQuery)}();
